#ifndef TCP_SERVER_HPP
#define TCP_SERVER_HPP

// Project headers
#include "network/tcp_connection.hpp"

// BOOST headers
#include <boost/asio.hpp>

namespace aio = boost::asio;
namespace sys = boost::system;
using boost::asio::ip::tcp;

namespace grader 
{
  class tcp_server 
  {
    //////////////////////////////////////////////////////////////////////////////
    // Members
    //////////////////////////////////////////////////////////////////////////////
    tcp::acceptor m_acceptor;
    
  public:
    //////////////////////////////////////////////////////////////////////////////
    // Creators and destructor
    //////////////////////////////////////////////////////////////////////////////
    tcp_server(aio::io_service& io_service);
    
    //////////////////////////////////////////////////////////////////////////////
    // Operations
    //////////////////////////////////////////////////////////////////////////////
  private:
    void start_accept();
    
    void handle_accept(tcp_connection::pointer newConnection, const sys::error_code& error);
  };
}

#endif // TCP_SERVER_HPP